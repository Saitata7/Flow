{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "User Settings Schema",
  "description": "Schema for user settings data in the Flow app",
  "type": "object",
  "properties": {
    "theme": {
      "type": "string",
      "enum": ["light", "dark", "auto"],
      "description": "App theme preference"
    },
    "accentColor": {
      "type": "string",
      "pattern": "^#[0-9A-Fa-f]{6}$",
      "description": "Accent color in hex format"
    },
    "textSize": {
      "type": "string",
      "enum": ["small", "medium", "large"],
      "description": "Text size preference"
    },
    "highContrast": {
      "type": "boolean",
      "description": "High contrast mode enabled"
    },
    "cheatMode": {
      "type": "boolean",
      "description": "Cheat mode enabled for testing"
    },
    "highlightDayStreak": {
      "type": "boolean",
      "description": "Highlight day streak achievements"
    },
    "closeTime": {
      "type": "string",
      "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",
      "description": "Daily close time in HH:MM format"
    },
    "profile": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "maxLength": 50,
          "description": "User's full name"
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "User's email address"
        },
        "profilePicture": {
          "type": "string",
          "format": "uri",
          "description": "URL to profile picture"
        },
        "timeZone": {
          "type": "string",
          "description": "User's timezone"
        },
        "language": {
          "type": "string",
          "enum": ["en", "es", "fr"],
          "description": "Preferred language"
        }
      },
      "additionalProperties": false
    },
    "habitDefaults": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["binary", "quantitative", "time-based"],
          "description": "Default habit type"
        },
        "goalFrequency": {
          "type": "string",
          "enum": ["daily", "weekly", "custom"],
          "description": "Default goal frequency"
        },
        "repeatTimesPerWeek": {
          "type": "integer",
          "minimum": 1,
          "maximum": 7,
          "description": "Default repeat times per week"
        },
        "reminderMethod": {
          "type": "string",
          "enum": ["notification", "none"],
          "description": "Default reminder method"
        }
      },
      "required": ["type", "goalFrequency", "repeatTimesPerWeek", "reminderMethod"],
      "additionalProperties": false
    },
    "scoring": {
      "type": "object",
      "properties": {
        "showDetailedStats": {
          "type": "boolean",
          "description": "Show detailed statistics"
        },
        "showEmotionNotes": {
          "type": "boolean",
          "description": "Show emotion and notes"
        },
        "motivationalInsights": {
          "type": "boolean",
          "description": "Show motivational insights"
        }
      },
      "required": ["showDetailedStats", "showEmotionNotes", "motivationalInsights"],
      "additionalProperties": false
    },
    "emotionalLogging": {
      "type": "object",
      "properties": {
        "promptFrequency": {
          "type": "string",
          "enum": ["always", "fail/skip", "manual"],
          "description": "When to prompt for emotions"
        },
        "customEmotions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Custom emotion options"
        }
      },
      "required": ["promptFrequency", "customEmotions"],
      "additionalProperties": false
    },
    "social": {
      "type": "object",
      "properties": {
        "shareProgress": {
          "type": "boolean",
          "description": "Share progress with others"
        },
        "communityChallenges": {
          "type": "boolean",
          "description": "Participate in community challenges"
        },
        "peerEncouragement": {
          "type": "boolean",
          "description": "Receive peer encouragement"
        }
      },
      "required": ["shareProgress", "communityChallenges", "peerEncouragement"],
      "additionalProperties": false
    },
    "dataPrivacy": {
      "type": "object",
      "properties": {
        "cloudBackup": {
          "type": "boolean",
          "description": "Enable cloud backup"
        },
        "localBackup": {
          "type": "boolean",
          "description": "Enable local backup"
        },
        "clinicianConsent": {
          "type": "boolean",
          "description": "Consent to share with clinicians"
        }
      },
      "required": ["cloudBackup", "localBackup", "clinicianConsent"],
      "additionalProperties": false
    },
    "clinician": {
      "type": "object",
      "properties": {
        "enableDashboard": {
          "type": "boolean",
          "description": "Enable clinician dashboard"
        },
        "sharedData": {
          "type": "string",
          "enum": ["stats", "stats+notes"],
          "description": "Type of data to share"
        },
        "clinicians": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of authorized clinicians"
        }
      },
      "required": ["enableDashboard", "sharedData", "clinicians"],
      "additionalProperties": false
    },
    "integrations": {
      "type": "object",
      "properties": {
        "wearables": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Connected wearable devices"
        },
        "externalApps": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Connected external apps"
        }
      },
      "required": ["wearables", "externalApps"],
      "additionalProperties": false
    },
    "appBehavior": {
      "type": "object",
      "properties": {
        "defaultLandingPage": {
          "type": "string",
          "enum": ["dashboard", "today", "stats"],
          "description": "Default landing page"
        }
      },
      "required": ["defaultLandingPage"],
      "additionalProperties": false
    },
    "notifications": {
      "type": "object",
      "properties": {
        "dailyReminders": {
          "type": "boolean",
          "description": "Daily reminder notifications"
        },
        "weeklyReports": {
          "type": "boolean",
          "description": "Weekly report notifications"
        },
        "achievementAlerts": {
          "type": "boolean",
          "description": "Achievement alert notifications"
        },
        "communityUpdates": {
          "type": "boolean",
          "description": "Community update notifications"
        },
        "reminderTime": {
          "type": "string",
          "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",
          "description": "Reminder time in HH:MM format"
        },
        "quietHours": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Quiet hours enabled"
            },
            "start": {
              "type": "string",
              "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",
              "description": "Quiet hours start time"
            },
            "end": {
              "type": "string",
              "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",
              "description": "Quiet hours end time"
            }
          },
          "required": ["enabled", "start", "end"],
          "additionalProperties": false
        }
      },
      "required": ["dailyReminders", "weeklyReports", "achievementAlerts", "communityUpdates", "reminderTime", "quietHours"],
      "additionalProperties": false
    },
    "privacy": {
      "type": "object",
      "properties": {
        "profileVisibility": {
          "type": "string",
          "enum": ["private", "friends", "public"],
          "description": "Profile visibility level"
        },
        "shareStats": {
          "type": "boolean",
          "description": "Share statistics with others"
        },
        "shareAchievements": {
          "type": "boolean",
          "description": "Share achievements with others"
        },
        "allowFriendRequests": {
          "type": "boolean",
          "description": "Allow friend requests"
        },
        "showOnlineStatus": {
          "type": "boolean",
          "description": "Show online status"
        }
      },
      "required": ["profileVisibility", "shareStats", "shareAchievements", "allowFriendRequests", "showOnlineStatus"],
      "additionalProperties": false
    },
    "location": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Location services enabled"
        },
        "precision": {
          "type": "string",
          "enum": ["city", "neighborhood", "exact"],
          "description": "Location precision level"
        },
        "shareLocation": {
          "type": "boolean",
          "description": "Share location with others"
        }
      },
      "required": ["enabled", "precision", "shareLocation"],
      "additionalProperties": false
    },
    "schemaVersion": {
      "type": "integer",
      "description": "Schema version for migration purposes"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "Settings creation timestamp"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Settings last update timestamp"
    }
  },
  "required": [
    "theme",
    "accentColor",
    "textSize",
    "highContrast",
    "cheatMode",
    "highlightDayStreak",
    "closeTime",
    "profile",
    "habitDefaults",
    "scoring",
    "emotionalLogging",
    "social",
    "dataPrivacy",
    "clinician",
    "integrations",
    "appBehavior",
    "notifications",
    "privacy",
    "location",
    "schemaVersion",
    "createdAt",
    "updatedAt"
  ],
  "additionalProperties": false
}
